name = "stu"
main = "packages/api/src/index.ts"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# --- Static Assets (React SPA) ---
[assets]
directory = "packages/web/dist"
binding = "ASSETS"
not_found_handling = "single-page-application"

# --- D1 Database ---
[[d1_databases]]
binding = "DB"
database_name = "botschat-db"
database_id = "426011d3-5a96-48d5-b745-a894dc6213b1"
migrations_dir = "migrations"

# --- R2 Bucket ---
[[r2_buckets]]
binding = "MEDIA"
bucket_name = "botschat-media"

# --- Durable Objects ---
[durable_objects]
bindings = [
  { name = "CONNECTION_DO", class_name = "ConnectionDO" },
]

[[migrations]]
tag = "v1"
new_sqlite_classes = ["ConnectionDO"]

# --- Environment Variables ---
[vars]
ENVIRONMENT = "development"
DEV_AUTH_SECRET = "botschat-dev-secret-2026"
# Firebase project ID for Google/GitHub Sign-In token verification.
FIREBASE_PROJECT_ID = "botschat-130ff"
# Google OAuth Client IDs â€” used to verify native iOS/Android Google Sign-In tokens.
GOOGLE_WEB_CLIENT_ID = "670756745871-1anrnjukhhu0a550j86blm771a2k3jou.apps.googleusercontent.com"
GOOGLE_IOS_CLIENT_ID = "670756745871-ct1k370fk3h5oj3f3gdabqv1nq2b7r54.apps.googleusercontent.com"
# IMPORTANT: For production, set JWT_SECRET via `wrangler secret put JWT_SECRET`.
# The app will refuse to start in non-development mode without it.

# --- Dev settings ---
[dev]
port = 8787
